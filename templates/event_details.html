<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
        <title>{{ events['EventName'] }} - Event Details</title>
    </head>
        
        <body>
            <header>
                <h1>{{ events['EventName'] }}</h1>
            </header>
            <nav>
                {% if not session.logged_in %}
                <a href="{{ url_for('login') }}">Login</a>
                {% else %}
                <div class="logout-container">
                    <button class="logout-btn" onclick="window.location.href='/logout'">&#128274; Logout</button>
                </div>
                {% endif %}
            </nav>
            
            <div class="tabs">
                <button class="tab-button active" onclick="openTab(event, 'overview')">Overview</button>
                <button class="tab-button" onclick="openTab(event, 'live-reactions')">Live Reactions</button>
                <button class="tab-button" onclick="openTab(event, 'vr-status')">VR Event Status</button>
                <button class="tab-button" onclick="openTab(event, 'more-info')">More Info</button>
                <button class="tab-button" onclick="openTab(event, 'tickets')">Tickets</button>
            </div>
            
            <section id="overview" class="tab-content active">
                <h2>Event Information</h2>
                <p><strong>Date:</strong> {{ events['EventDate'] }}</p>
                <p><strong>Time:</strong> {{ events['StartTime'] }} - {{ events['EndTime'] }}</p>
                <p><strong>Description:</strong> {{ events['Description'] }}</p>
                <p><strong>Status:</strong> {{ events['Status'] }}</p>
                <p><strong>Budget:</strong> ${{ events['Budget'] }}</p>
                
                <h2>Venue Details</h2>
                <p><strong>Venue:</strong> {{ venues['VenueName'] }}</p>
                <p><strong>Capacity:</strong> {{ venues['Capacity'] }}</p>
                <p><strong>Location:</strong> {{ venues['Location'] }}</p>
            </section>
            
            <section id="live-reactions" class="tab-content">
                <h2>Live Reactions</h2>
                <div id="mastodon-feed">
                    <p>Loading live reactions from Mastodon...</p>
                </div>
            </section>
            
            <section id="vr-status" class="tab-content">
                <h2>VR Event Status</h2>
                <p>Current VR status of this event:</p>
                <div id="vr-status-panel">
                    <p>Loading VR event details...</p>
                </div>
            </section>
            
            <section id="more-info" class="tab-content">
                <h2>Organizer</h2>
                <p><strong>Name:</strong> {{organizer['OrganizerName']}}</p>
                <p><strong>Contact:</strong> {{organizer['ContactPerson'] }} - {{organizer['ContactNumber'] }}</p>
                <p><strong>Email:</strong> {{organizer['Email'] }}</p>
                
                <h2>Attendees</h2>
                <p>Total attendees: {{ attendees|length }}</p>
                <ul>
                    {% for attendee in attendees %}
                    <li>{{ attendee.FirstName }} {{ attendee.LastName }}</li>
                    {% endfor %}
                </ul>

                <h2>Sessions</h2>
                <ul>
                    {% for session in sessions %}
                    <li>{{ session['Title'] }} by {{ session['SpeakerID']['SpeakerName'] }}</li>
                    {% endfor %}
                </ul>
                
                <h2>Speakers</h2>
                <ul>
                    {% for speaker in speakers %}
                    <li>{{ speaker['SpeakerName'] }} - {{ speaker['Bio'] }}</li>
                    {% endfor %}
                </ul>

                <h2>Sponsors</h2>
                <ul>
                    {% for sponsor in sponsors %}
                    <li>{{ sponsor['SponsorName'] }} - ${{ sponsor['Contribution'] }}</li>
                    {% endfor %}
                </ul>

                <h2>Social Media Promotions</h2>
                <ul>
                    {% for promotion in social_media_promotions %}
                    <li>{{ promotion['Platform'] }}: {{ promotion['Content'] }} ({{ promotion['DatePosted'] }})</li>
                    {% endfor %}
                </ul>
                                
                <h2>Tickets</h2>
                <form action="{{ url_for('buy_ticket', event_id=events['EventID']) }}" method="POST" class="ticket-form">
                    <label for="attendee_name">Your Name:</label>
                    <input type="text" id="attendee_name" name="attendee_name" required>
                    <button type="submit">Buy Ticket</button>
                </form>
                <h3>Attendees ({{ tickets|length }})</h3>
                <ul>
                    {% for ticket in tickets %}
                    <li>{{ ticket.attendee_name }} (purchased: {{ ticket.purchase_time }})</li>
                    {% else %}
                    <li>No tickets purchased yet.</li>
                    {% endfor %}
                </ul>
            </section>
            
            <a href="{{ url_for('index') }}" class="back-button">‚Üê Back to Events</a>
            
            <script>
            function openTab(evt, tabName) {
                var i, tabcontent, tabbuttons;
                tabcontent = document.getElementsByClassName("tab-content");
                for (i = 0; i < tabcontent.length; i++) {
                    tabcontent[i].classList.remove("active");
                }
                tabbuttons = document.getElementsByClassName("tab-button");
                for (i = 0; i < tabbuttons.length; i++) {
                    tabbuttons[i].classList.remove("active");
                }
                document.getElementById(tabName).classList.add("active");
                evt.currentTarget.classList.add("active");
                }
            </script>
        </body>
</html>